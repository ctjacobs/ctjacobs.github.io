---
layout: default
title: Computational Fluid Dynamics - Research
keywords: computational science, computational fluid dynamics, multiphase flow, mesh adaptivity, adaptive unstructured mesh, volcanic ash, numerical modelling, numerical methods, fluidity, firedrake-fluids, opensbli
---

<article id="main">

   <header class="special container">
	   <span class="icon fa-cogs"></span>
	   <h2><strong>Research</strong></h2>
	   <p><h3>Computational Fluid Dynamics</h3></p>
   </header>

   <!-- Multiphase flow -->
   <section class="wrapper style1 container">
   
      <!-- Content -->
      <div class="content">
      <header>
         <h2>Multiphase flow</h2>
      </header>
      <p>As part of my research undertaken at Imperial College London, I have developed incompressible and compressible multiphase flow models in <a href="http://www.fluidity-project.org/">Fluidity</a> --- an open-source,  computational fluid dynamics package. Fluidity features an adaptive unstructured mesh approach which provides finer resolution in areas significantly important to the dynamics being studied and coarser resolution in those areas that are not. As the flow progresses, the mesh is optimised to maintain numerical accuracy while minimising the number of superfluous nodes. Furthermore, Fluidity can run in parallel over thousands of computer processors using the Message Passing Interface (MPI), making the study of large-scale geophysical phenomena feasible in complex 3D domains.</p>
      
      <p>
      <center>
         <div class="image fit">
            <img style="max-width:600px;" src="/images/ash-settling-3d.jpg" alt="A three-dimensional multiphase flow simulation of volcanic ash settling in a water column. The simulation was performed using Fluidity."/>
         </div>
         <p>
         <i>Visualisation of the particle volume fraction field, from a three-dimensional multiphase flow simulation of volcanic ash settling in a water column.<br>
         The simulation was performed using Fluidity.</i>
         </p>
      </center>
      </p>
      
      <p>Some multiphase applications of Fluidity are described in the following subsections. Further information can be found in my PhD thesis:<br>
      <ul class="default">
         <li>C. T. Jacobs (2013). <b>Modelling of multiphase flows on adaptive unstructured meshes with applications to the dynamics of volcanic ash plumes</b>. <i>PhD Thesis, Imperial College London</i>. Handle: <a href="http://hdl.handle.net/10044/1/12785">10044/1/12785</a>.</li>
      </ul>
      </p>
      
      </div>
   </section>
   
   <!-- Volcanic ash settling in water -->
   <section class="wrapper style1 container">
   
      <!-- Content -->
      <div class="content">
      <header>
         <h3>Volcanic ash settling in water</h3>
      </header>

      <p>Significant proportions of ash generated from explosive volcanic eruptions are found far and wide along the seabed in the form of ash layers. The study of ash particle dynamics in water is needed to better interpret these layers, which are important to geoscientists since they hold valuable information about the duration and frequency of volcanism. Early work (e.g. <a href="http://dx.doi.org/10.1016/0011-7471(65)90006-9">Fisher (1965)</a>) assumed that ash particles settled individually at a velocity given by Stokes' law, and that layers are not significantly modified after formation. However, laboratory experiments and analysis of marine sediment cores have demonstrated the potential role of vertical density currents in transporting particles rapidly and collectively to the seabed, contradicting the assumption of individual particle settling.</p>

      <p>Fluidity was used to simulate a laboratory experiment of tephra (fine volcanic ash particles) settling through a tank of water, performed by <a href="http://dx.doi.org/10.1130/0091-7613(1997)​025<0839:IOCSOT>​2.3.CO;2">Carey (1997)</a>. The numerical results are shown in the video below, with the particle volume fraction field shown on the left and the adaptive unstructured mesh on the right.</p>
      
      <p>
      <center>
      <iframe frameborder="0" width="100%" style="max-width:640px; min-height:390px;" src="http://www.youtube.com/embed/Ou7boMlfmew"> </iframe>
      </center>
      </p>
      
      <p>At early times, when the concentration of particles was low, particles settled individually under Stokes’ law. This caused a layer of particle-rich water to form that increased in particle concentration with time. The layer eventually became unstable when the layer concentration grew large enough for particles to have an effect on each other through drag reduction and drifting, causing the particles to settle collectively as plumes as observed in the experiment. The collective transport of particles to the bottom of the tank happened at speeds several times greater than that of single particles, highlighting the important role of vertical density currents.</p>

      <p>
      Similar behaviour was also seen in simulations of a laboratory-scale settling experiment by <a href="http://dx.doi.org/10.1144/0016-764903-067">Manville & Wilson (2004)</a> involving silicon carbide particles:
      </p>
      
      <p>
      <center>
      <iframe frameborder="0" width="100%" style="max-width:640px; min-height:390px;" src="http://www.youtube.com/embed/R8oUtwAx2fw"> </iframe>
      </center>
      </p>
      
      <p>The results of this research have been published in Geophysical Journal International and the Journal of Volcanology and Geothermal Research:
      <ul class="default">
         <li>C. T. Jacobs, G. S. Collins, M. D. Piggott, S. C. Kramer, C. R. G. Wilson (2013). <b>Multiphase flow modelling of volcanic ash particle settling in water using adaptive unstructured meshes</b>. <i>Geophysical Journal International</i>, 192(2):647-665, DOI: <a href="http://dx.doi.org/10.1093/gji/ggs059">10.1093/gji/ggs059</a>. <a href="http://gji.oxfordjournals.org/cgi/reprint/ggs059?ijkey=7ZmLeKIeBfzZmDV&keytype=ref">Free-access link</a>.</li><br>
         <li>C. T. Jacobs, T. J. Goldin, G. S. Collins, M. D. Piggott, S. C. Kramer, H. J. Melosh, C. R. G. Wilson, P. A. Allison (2015). <b>An improved quantitative measure of the tendency for volcanic ash plumes to form in water: implications for the deposition of marine ash beds</b>. <i>Journal of Volcanology and Geothermal Research</i>, 290:114-124, DOI: <a href="http://dx.doi.org/10.1016/j.jvolgeores.2014.10.015">10.1016/j.jvolgeores.2014.10.015</a>. <a href="http://christianjacobs.uk/papers/Jacobs_etal_2015_author_accepted_manuscript.pdf">Link to author accepted manuscript</a>.</li>
      </ul>
      </p>

      </div>
   </section>
   
   <!-- Explosive volcanic eruptions -->
   <section class="wrapper style1 container">
   
      <!-- Content -->
      <div class="content">
      <header>
         <h3>Explosive volcanic eruptions</h3>
      </header>

      <p>The images below show the particle volume fraction field at t = 10, 30 and 70 seconds (left to right) from a two-dimensional compressible multiphase flow simulation of an explosive volcanic eruption. Hot gas and ash particles are ejected into the atmosphere at 80 m/s. The results show the formation of an overhanging vortex as the plume ascends, followed by the collapse of the ash column which forms a thick pyroclastic density current. A convective region is also present above the ash fountain which continues to rise as a result of buoyancy effects. Once again, the simulation was performed using Fluidity. A fixed structured mesh, with a characteristic element length of 12.5 m, was used to discretise the 7 km by 7 km domain.</p>

      <p>
      <center>
      <div class="image fit">
         <img style="max-width:650px;" src="/images/eruption_vfrac.png" alt="Simulation of an explosive volcanic eruption using Fluidity. Images by Christian Jacobs."/>
      </div>
      <p><i>Simulation of an explosive volcanic eruption using Fluidity.<br>
      Left-to-right: particle volume fraction field at t = 10, 30 and 70 s.<br>
      Images by Christian Jacobs.</i></p>
      </center>
      </p>
      
      <p>The results of some simulations of explosive volcanic eruptions performed with adaptive unstructured meshes have been presented in the following conference paper:
      <ul class="default">
         <li>C. T. Jacobs, G. S. Collins, M. D. Piggott, S. C. Kramer (2014). <b>Multiphase flow modelling of explosive volcanic eruptions using an adaptive unstructured mesh-based approach</b>. In <i>Proceedings of the jointly organized 11th World Congress on Computational Mechanics (WCCM XI), 5th European Congress on Computational Mechanics (ECCM V), and 6th European Congress on Computational Fluid Dynamics (ECFD VI), held in Barcelona, Spain on 20-25 July 2014</i>. Pages 7406-7417. Handle: <a href="http://hdl.handle.net/10044/1/21241">10044/1/21241</a>. Links: <a href="http://www.wccm-eccm-ecfd2014.org/admin/files/filePaper/p313.pdf">Paper</a>, <a href="http://www.wccm-eccm-ecfd2014.org/ebook.zip">Full proceedings</a></li>
      </ul>
      </p>
      
      </div>
   </section>


   <!-- Code generation -->
   <section class="wrapper style1 container">
   
      <!-- Content -->
      <div class="content">
      <header>
         <h2>Code generation</h2>
      </header>
      <p>Traditional numerical model development involves the production of hand-written computer code to implement the underlying discretisation and solution algorithms. As high-performance computing hardware continues to evolve, the task of maintaining codes such as these becomes harder than ever, often involving re-writes in order to support the new hardware and run simulations on it as efficiently as possible. This puts a huge burden on the numerical modeller to not only be an expert in their domain of study but also in numerical methods and parallel computing. My most recent research has focussed on the use of code generation techniques, whereby the numerical model's underlying code is produced automatically from a high-level problem specification. This code can then in turn be targetted towards a range of different hardware architectures such as multi-core CPUs, GPUs and Intel Xeon Phi coprocessors. The layers of abstraction that are introduced means that the model equations and the discretisation procedures need only be written once at the high-level.</p>

      <p>I have led the development of the <a href="https://github.com/firedrakeproject/firedrake-fluids">Firedrake-Fluids</a> project which uses <a href="http://www.firedrakeproject.org/">Firedrake</a> to automatically discretise and solve the shallow water equations with the finite element method. More recently, I have played a key role in the development of <a href="https://opensbli.github.io/">OpenSBLI</a> --- a framework for the derivation of finite difference-based models, which also uses source-to-source translation to target the code towards different hardware backends with the help of the <a href="http://www.oerc.ox.ac.uk/projects/ops">OPS</a> library.</p>

      <p>
      <center>
      <div class="image fit">
         <img style="max-width:400px;" src="/images/taylor_green_vortex.png" alt="Simulation of the Taylor-Green vortex problem, performed using OpenSBLI."/>
      </div>
      <p><i>Simulation of the Taylor-Green vortex problem, performed using OpenSBLI on an NVIDIA Tesla
K40c Graphics Processing Unit.<br>
      Isosurfaces of the z-component of vorticity are shown.<br>
      Approximately 1,500 lines of C code (which solve the compressible Navier-Stokes equations using a fourth-order finite difference scheme) were generated from a high-level problem description comprising approximately 100 lines of Python code.<br>
      Images by Jacobs <i>et al.</i> (2017).</i></p>
      </center>
      </p>
      
      <p>Further details can be found in the following papers:
      <ul class="default">
         <li>C. T. Jacobs, M. D. Piggott (2015). <b>Firedrake-Fluids v0.1: numerical modelling of shallow water flows using an automated solution framework</b>. <i>Geoscientific Model Development</i>, 8(3):533-547, DOI: <a href="http://dx.doi.org/10.5194/gmd-8-533-2015">10.5194/gmd-8-533-2015</a>.</li><br>
         <li>C. T. Jacobs, M. D. Piggott, S. C. Kramer, S. W. Funke (2016). <b>On the validity of tidal turbine array configurations obtained from steady-state adjoint optimisation</b>. In <i>Proceedings of the VII European Congress on Computational Methods in Applied Sciences and Engineering, held in Crete, Greece on 5-10 June 2016</i>. <a href="https://arxiv.org/abs/1601.08091">Pre-print</a>.</li><br>
         <li>C. T. Jacobs, S. P. Jammy, N. D. Sandham (2017). <b>OpenSBLI: A framework for the automated derivation and parallel execution of finite difference solvers on a range of computer architectures</b>. <i>Journal of Computational Science</i>, 18:12-23, DOI: <a href="http://dx.doi.org/10.1016/j.jocs.2016.11.001">10.1016/j.jocs.2016.11.001</a>.</li><br>
         <li>S. P. Jammy, C. T. Jacobs, N. D. Sandham (In Press). <b>Performance evaluation of explicit finite difference algorithms with varying amounts of computational and memory intensity</b>. <i>Journal of Computational Science</i>, DOI: <a href="http://dx.doi.org/10.1016/j.jocs.2016.10.015">10.1016/j.jocs.2016.10.015</a>.</li>
      </ul>
      </p>
      
      </div>
   </section>
</article>
